<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignalFlow Project - Dashboard Interactivo</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: #fff;
            min-height: 100vh;
        }

        .header {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            backdrop-filter: blur(10px);
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .controls {
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .search-box {
            padding: 10px 15px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            placeholder-color: rgba(255, 255, 255, 0.7);
        }

        .search-box::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            padding: 20px;
            height: calc(100vh - 200px);
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            overflow-y: auto;
        }

        .visualization {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .module-section {
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
        }

        .module-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #4ecdc4;
            border-bottom: 2px solid #4ecdc4;
            padding-bottom: 5px;
        }

        .file-item {
            background: rgba(255, 255, 255, 0.1);
            margin: 5px 0;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .file-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .file-item.selected {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
        }

        .file-type {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7em;
            margin-right: 8px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #4ecdc4;
        }

        .stat-label {
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.8);
        }

        .dependency-graph {
            width: 100%;
            height: 100%;
        }

        .node {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .node:hover {
            stroke-width: 3px;
            stroke: #fff;
        }

        .link {
            stroke: rgba(255, 255, 255, 0.3);
            stroke-width: 1.5px;
        }

        .node-label {
            fill: white;
            font-size: 10px;
            text-anchor: middle;
            pointer-events: none;
        }

        .tooltip {
            position: absolute;
            padding: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border-radius: 5px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1> SignalFlow Project Dashboard</h1>
        <p>Mapa mental interactivo del sistema de se帽ales reactivo enterprise-grade</p>
    </div>

    <div class="controls">
        <div class="filter-group">
            <button class="filter-btn active" data-filter="all">Todos</button>
            <button class="filter-btn" data-filter="core">Core</button>
            <button class="filter-btn" data-filter="signals">Signals</button>
            <button class="filter-btn" data-filter="registry">Registry</button>
            <button class="filter-btn" data-filter="storage">Storage</button>
            <button class="filter-btn" data-filter="replication">Replication</button>
            <button class="filter-btn" data-filter="security">Security</button>
            <button class="filter-btn" data-filter="tests">Tests</button>
        </div>
        <input type="text" class="search-box" placeholder="Buscar archivos..." id="searchBox">
    </div>

    <div class="dashboard">
        <div class="sidebar">
            <div class="stats">
                <div class="stat">
                    <div class="stat-number" id="totalFiles">0</div>
                    <div class="stat-label">Archivos Total</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="headerFiles">0</div>
                    <div class="stat-label">Headers (.h)</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="sourceFiles">0</div>
                    <div class="stat-label">Sources (.cpp)</div>
                </div>
            </div>

            <div id="fileTree"></div>
        </div>

        <div class="visualization">
            <svg class="dependency-graph"></svg>
            <div class="tooltip"></div>
        </div>
    </div>

    <script>
        // Datos del proyecto SignalFlow
        const projectData = {
            core: {
                name: "Core System",
                color: "#ff6b6b",
                files: [
                    { name: "Signal.h", type: "h", description: "Descriptor puro para se帽ales con almacenamiento basado en arquetipos" },
                    { name: "SignalTypes.h", type: "h", description: "Sistema de tipos fundamental y conceptos C++20" },
                    { name: "SignalConcepts.h", type: "h", description: "Conceptos C++20 para validaci贸n de tipos en tiempo de compilaci贸n" },
                    { name: "SignalLocation.h", type: "h", description: "Sistema de ubicaci贸n espacial para se帽ales" },
                    { name: "SignalWatcher.h", type: "h", description: "Observador de cambios en se帽ales" },
                    { name: "DependentSignal.h", type: "h", description: "Se帽ales que dependen de otras se帽ales" },
                    { name: "MergedObservable.h", type: "h", description: "Combinaci贸n de m煤ltiples observables" },
                    { name: "PreviousSignalKey.h", type: "h", description: "Clave para acceder a valores previos de se帽ales" },
                    { name: "TypeTraits.h", type: "h", description: "Caracter铆sticas de tipo para el sistema" }
                ]
            },
            signals: {
                name: "Signal Types & Behaviors",
                color: "#4ecdc4",
                files: [
                    { name: "MutableSignal.h", type: "h", description: "Se帽ales mutables con estado modificable" },
                    { name: "Computed.h", type: "h", description: "Se帽ales computadas a partir de otras se帽ales" },
                    { name: "DynamicComputedSignal.h", type: "h", description: "Se帽ales computadas din谩micamente" },
                    { name: "FoldSignal.h", type: "h", description: "Acumulaci贸n de valores a lo largo del tiempo" },
                    { name: "LerpSignal.h", type: "h", description: "Interpolaci贸n lineal entre valores" },
                    { name: "SmoothSignal.h", type: "h", description: "Suavizado de valores con filtros" },
                    { name: "ThrottleSignal.h", type: "h", description: "Control de frecuencia de actualizaci贸n" },
                    { name: "WatchSignal.h", type: "h", description: "Observaci贸n de cambios con callbacks" },
                    { name: "StoreSignal.h", type: "h", description: "Almacenamiento persistente de valores" },
                    { name: "PeekSignal.h", type: "h", description: "Acceso de solo lectura sin suscripci贸n" },
                    { name: "PreviousSignal.h", type: "h", description: "Acceso a valores previos de se帽ales" }
                ]
            },
            behaviors: {
                name: "Signal Behaviors",
                color: "#95e1d3",
                files: [
                    { name: "SignalBehavior.h", type: "h", description: "Comportamiento base para todas las se帽ales" },
                    { name: "MutableSignalBehavior.h", type: "h", description: "Comportamiento de se帽ales mutables" },
                    { name: "DynamicComputedSignalBehavior.h", type: "h", description: "Comportamiento de se帽ales computadas din谩micas" },
                    { name: "FoldSignalBehavior.h", type: "h", description: "Comportamiento de acumulaci贸n" },
                    { name: "LerpSignalBehavior.h", type: "h", description: "Comportamiento de interpolaci贸n" },
                    { name: "SmoothSignalBehavior.h", type: "h", description: "Comportamiento de suavizado" },
                    { name: "ThrottleSignalBehavior.h", type: "h", description: "Comportamiento de throttling" },
                    { name: "CacheSignalBehavior.h", type: "h", description: "Comportamiento de cach茅" },
                    { name: "StoreSignalBehavior.h", type: "h", description: "Comportamiento de almacenamiento" },
                    { name: "PeekSignalBehavior.h", type: "h", description: "Comportamiento de peek" },
                    { name: "PreviousSignalBehavior.h", type: "h", description: "Comportamiento de valores previos" }
                ]
            },
            operators: {
                name: "Signal Operators",
                color: "#a8e6cf",
                files: [
                    { name: "SignalOperators.h", type: "h", description: "Operadores principales para se帽ales" },
                    { name: "ArithmeticOperators.h", type: "h", description: "Operadores aritm茅ticos (+, -, *, /)" },
                    { name: "ComparisonOperators.h", type: "h", description: "Operadores de comparaci贸n (==, !=, <, >)" },
                    { name: "LogicalOperators.h", type: "h", description: "Operadores l贸gicos (&&, ||, !)" },
                    { name: "ConditionalOperators.h", type: "h", description: "Operadores condicionales (if/else)" },
                    { name: "MutableOperators.h", type: "h", description: "Operadores para se帽ales mutables" },
                    { name: "CoreOperators.h", type: "h", description: "Operadores fundamentales del sistema" }
                ]
            },
            registry: {
                name: "Registry & Management",
                color: "#ffd93d",
                files: [
                    { name: "SignalRegistrySubsystem.h", type: "h", description: "Subsistema de registro para gesti贸n de ciclo de vida" },
                    { name: "SignalRegistry.cpp", type: "cpp", description: "Implementaci贸n del registro central de se帽ales" },
                    { name: "SignalTimerManagerSubsystem.h", type: "h", description: "Gesti贸n de temporizadores para se帽ales" },
                    { name: "SignalTimerSubsystem.h", type: "h", description: "Subsistema de temporizadores" },
                    { name: "SignalIterators.h", type: "h", description: "Iteradores para recorrer se帽ales" },
                    { name: "SignalIntegrityChecker.h", type: "h", description: "Verificaci贸n de integridad del sistema" }
                ]
            },
            storage: {
                name: "Storage System",
                color: "#a8c8ec",
                files: [
                    { name: "RawSignalStorage.h", type: "h", description: "Almacenamiento de bajo nivel para se帽ales" },
                    { name: "RawSignalChunk.h", type: "h", description: "Chunks de memoria para almacenamiento eficiente" },
                    { name: "RawSignalHandle.h", type: "h", description: "Handles para acceso a almacenamiento" },
                    { name: "RawSignalValueStorage.h", type: "h", description: "Almacenamiento espec铆fico de valores" },
                    { name: "SignalShardChunkPool.h", type: "h", description: "Pool de chunks para sharding de memoria" }
                ]
            },
            replication: {
                name: "Network Replication",
                color: "#ff9ff3",
                files: [
                    { name: "SignalReplication.h", type: "h", description: "Sistema de replicaci贸n de red" },
                    { name: "SignalReplicationManager.h", type: "h", description: "Gesti贸n de replicaci贸n" },
                    { name: "ReplicationSerialization.h", type: "h", description: "Serializaci贸n para replicaci贸n" },
                    { name: "ReplicationHeader.h", type: "h", description: "Headers para paquetes de replicaci贸n" },
                    { name: "SignalRelevancy.h", type: "h", description: "Relevancia de se帽ales para replicaci贸n" }
                ]
            },
            security: {
                name: "Security & Anti-Cheat",
                color: "#f38ba8",
                files: [
                    { name: "AntiDebugging.h", type: "h", description: "Protecci贸n contra debugging" },
                    { name: "UltraFastSecurity.cpp", type: "cpp", description: "Sistema de seguridad ultra-r谩pido" },
                    { name: "IntegrityProtection.cpp", type: "cpp", description: "Protecci贸n de integridad" },
                    { name: "TimeProtection.cpp", type: "cpp", description: "Protecci贸n contra manipulaci贸n de tiempo" },
                    { name: "FSessionKeyManager.cpp", type: "cpp", description: "Gesti贸n de claves de sesi贸n" }
                ]
            },
            observers: {
                name: "Observers & Queries",
                color: "#94d3f0",
                files: [
                    { name: "SignalObservable.h", type: "h", description: "Observable base para se帽ales" },
                    { name: "ObserverPriority.h", type: "h", description: "Sistema de prioridades para observadores" },
                    { name: "QueryView.h", type: "h", description: "Vistas de consulta para se帽ales" },
                    { name: "SpatialSensor.h", type: "h", description: "Sensor espacial para ubicaciones" }
                ]
            },
            tests: {
                name: "Test Suite",
                color: "#c9a96e",
                files: [
                    { name: "ConstantSignalLifecycleTest.cpp", type: "cpp", description: "Tests de ciclo de vida de se帽ales constantes" },
                    { name: "MutableSignalLifecycleTest.cpp", type: "cpp", description: "Tests de ciclo de vida de se帽ales mutables" },
                    { name: "ComputedSignalLifecycleTest.cpp", type: "cpp", description: "Tests de se帽ales computadas" },
                    { name: "DynamicComputedSignalLifecycleTest.cpp", type: "cpp", description: "Tests de se帽ales computadas din谩micas" },
                    { name: "MutableComputedSignalLifecycleTest.cpp", type: "cpp", description: "Tests de se帽ales computadas mutables" },
                    { name: "PredictedSignalLifecycleTest.cpp", type: "cpp", description: "Tests de se帽ales predictivas" },
                    { name: "DebounceSignalLifecycleTest.cpp", type: "cpp", description: "Tests de debounce" },
                    { name: "SignalTimerTest.cpp", type: "cpp", description: "Tests del sistema de temporizadores" },
                    { name: "DependencyTrackingTest.cpp", type: "cpp", description: "Tests de seguimiento de dependencias" }
                ]
            },
            utils: {
                name: "Utilities",
                color: "#b4a7d6",
                files: [
                    { name: "BufferPool.h", type: "h", description: "Pool de buffers para optimizaci贸n de memoria" },
                    { name: "CircularBuffer.h", type: "h", description: "Buffer circular para datos temporales" },
                    { name: "SignalTypeHash.cpp", type: "cpp", description: "Hash de tipos para identificaci贸n r谩pida" }
                ]
            }
        };

        // Variables globales
        let currentFilter = 'all';
        let selectedFile = null;
        let searchTerm = '';

        // Inicializaci贸n
        document.addEventListener('DOMContentLoaded', function() {
            initializeFilters();
            initializeSearch();
            renderFileTree();
            renderVisualization();
            updateStats();
        });

        function initializeFilters() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    renderFileTree();
                    renderVisualization();
                    updateStats();
                });
            });
        }

        function initializeSearch() {
            const searchBox = document.getElementById('searchBox');
            searchBox.addEventListener('input', function() {
                searchTerm = this.value.toLowerCase();
                renderFileTree();
                renderVisualization();
                updateStats();
            });
        }

        function getFilteredData() {
            if (currentFilter === 'all') {
                return projectData;
            }
            const filtered = {};
            if (projectData[currentFilter]) {
                filtered[currentFilter] = projectData[currentFilter];
            }
            return filtered;
        }

        function matchesSearch(file) {
            if (!searchTerm) return true;
            return file.name.toLowerCase().includes(searchTerm) ||
                   file.description.toLowerCase().includes(searchTerm);
        }

        function renderFileTree() {
            const fileTree = document.getElementById('fileTree');
            const data = getFilteredData();

            fileTree.innerHTML = '';

            Object.entries(data).forEach(([key, module]) => {
                const section = document.createElement('div');
                section.className = 'module-section';

                const title = document.createElement('div');
                title.className = 'module-title';
                title.textContent = module.name;
                title.style.color = module.color;
                section.appendChild(title);

                const filteredFiles = module.files.filter(matchesSearch);

                filteredFiles.forEach(file => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <span class="file-type">${file.type}</span>
                        ${file.name}
                    `;
                    fileItem.addEventListener('click', () => selectFile(file, module));
                    section.appendChild(fileItem);
                });

                if (filteredFiles.length > 0) {
                    fileTree.appendChild(section);
                }
            });
        }

        function selectFile(file, module) {
            // Remover selecci贸n previa
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('selected');
            });

            // Seleccionar nuevo archivo
            event.currentTarget.classList.add('selected');
            selectedFile = { file, module };

            // Actualizar visualizaci贸n
            highlightNode(file.name);
        }

        function updateStats() {
            const data = getFilteredData();
            let totalFiles = 0, headerFiles = 0, sourceFiles = 0;

            Object.values(data).forEach(module => {
                const filteredFiles = module.files.filter(matchesSearch);
                totalFiles += filteredFiles.length;
                headerFiles += filteredFiles.filter(f => f.type === 'h').length;
                sourceFiles += filteredFiles.filter(f => f.type === 'cpp').length;
            });

            document.getElementById('totalFiles').textContent = totalFiles;
            document.getElementById('headerFiles').textContent = headerFiles;
            document.getElementById('sourceFiles').textContent = sourceFiles;
        }

        function renderVisualization() {
            const svg = d3.select('.dependency-graph');
            svg.selectAll("*").remove();

            const width = svg.node().clientWidth;
            const height = svg.node().clientHeight;

            const data = getFilteredData();
            const nodes = [];
            const links = [];

            // Crear nodos
            Object.entries(data).forEach(([key, module], moduleIndex) => {
                const filteredFiles = module.files.filter(matchesSearch);

                // Nodo del m贸dulo
                nodes.push({
                    id: key,
                    name: module.name,
                    type: 'module',
                    color: module.color,
                    size: 20,
                    files: filteredFiles.length
                });

                // Nodos de archivos
                filteredFiles.forEach((file, fileIndex) => {
                    const nodeId = `${key}_${file.name}`;
                    nodes.push({
                        id: nodeId,
                        name: file.name,
                        type: 'file',
                        fileType: file.type,
                        color: file.type === 'h' ? '#4ecdc4' : '#ff6b6b',
                        size: 8,
                        description: file.description,
                        module: key
                    });

                    // Link del m贸dulo al archivo
                    links.push({
                        source: key,
                        target: nodeId
                    });
                });
            });

            // Crear links entre m贸dulos relacionados
            const moduleKeys = Object.keys(data);
            const dependencies = {
                'core': ['signals', 'registry', 'storage'],
                'signals': ['behaviors', 'operators'],
                'registry': ['storage', 'security'],
                'replication': ['security', 'storage'],
                'tests': ['core', 'signals', 'registry', 'storage']
            };

            moduleKeys.forEach(source => {
                if (dependencies[source]) {
                    dependencies[source].forEach(target => {
                        if (moduleKeys.includes(target)) {
                            links.push({
                                source: source,
                                target: target,
                                type: 'dependency'
                            });
                        }
                    });
                }
            });

            // Configurar simulaci贸n de fuerza
            const simulation = d3.forceSimulation(nodes)
                .force('link', d3.forceLink(links).id(d => d.id).distance(100))
                .force('charge', d3.forceManyBody().strength(-300))
                .force('center', d3.forceCenter(width / 2, height / 2))
                .force('collision', d3.forceCollide().radius(d => d.size + 5));

            // Crear enlaces
            const link = svg.append('g')
                .selectAll('line')
                .data(links)
                .enter().append('line')
                .attr('class', 'link')
                .attr('stroke', d => d.type === 'dependency' ? '#ffd93d' : 'rgba(255,255,255,0.3)')
                .attr('stroke-width', d => d.type === 'dependency' ? 2 : 1);

            // Crear nodos
            const node = svg.append('g')
                .selectAll('circle')
                .data(nodes)
                .enter().append('circle')
                .attr('class', 'node')
                .attr('r', d => d.size)
                .attr('fill', d => d.color)
                .attr('stroke', '#fff')
                .attr('stroke-width', 2)
                .call(d3.drag()
                    .on('start', dragstarted)
                    .on('drag', dragged)
                    .on('end', dragended));

            // Etiquetas
            const labels = svg.append('g')
                .selectAll('text')
                .data(nodes)
                .enter().append('text')
                .attr('class', 'node-label')
                .attr('dy', d => d.size + 15)
                .style('font-size', d => d.type === 'module' ? '12px' : '9px')
                .style('font-weight', d => d.type === 'module' ? 'bold' : 'normal')
                .text(d => d.name);

            // Tooltip
            const tooltip = d3.select('.tooltip');

            node
                .on('mouseover', function(event, d) {
                    tooltip.transition().duration(200).style('opacity', .9);
                    tooltip.html(`
                        <strong>${d.name}</strong><br/>
                        ${d.type === 'file' ? `Tipo: ${d.fileType}<br/>` : ''}
                        ${d.description || (d.type === 'module' ? `${d.files} archivos` : '')}
                    `)
                    .style('left', (event.pageX + 10) + 'px')
                    .style('top', (event.pageY - 28) + 'px');
                })
                .on('mouseout', function(d) {
                    tooltip.transition().duration(500).style('opacity', 0);
                })
                .on('click', function(event, d) {
                    if (d.type === 'file') {
                        highlightNode(d.name);
                    }
                });

            // Actualizar posiciones
            simulation.on('tick', () => {
                link
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);

                node
                    .attr('cx', d => d.x)
                    .attr('cy', d => d.y);

                labels
                    .attr('x', d => d.x)
                    .attr('y', d => d.y);
            });

            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }

            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }

            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
        }

        function highlightNode(fileName) {
            d3.selectAll('.node')
                .attr('stroke-width', d => d.name === fileName ? 4 : 2)
                .attr('stroke', d => d.name === fileName ? '#ffd93d' : '#fff');
        }

        // Responsive
        window.addEventListener('resize', () => {
            renderVisualization();
        });
    </script>
</body>
</html>